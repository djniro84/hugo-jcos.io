<!-- "site root"\layouts\shortcodes\foldergallery.html -->

<style>
  div.gallery {
    display: flex;
    flex-wrap: wrap;
  }
  div.gallery a {
    flex-grow: 1;
    object-fit: cover;
    margin: 5px;
    display: flex;
  }

  div.gallery a img {
    height: 300px;
    object-fit: cover;
    flex-grow: 1;
  }

</style>

<script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<div class="gallery">

  {{ $gallery := .Get "src" }}
  {{ range $.Page.Params.gallery }}

  <a data-fancybox="gallery" href="#">
    <img
            srcset='
      {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryDefault }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ $gallery }}/{{ . }},
      {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryMedium }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ $gallery }}/{{ . }},
      {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryLarge }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ $gallery }}/{{ . }}
      '
            src="{{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryDefault }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ . }}"
    >
    <br>

  </a>

  {{ end }}

  {{ with .Page.Resources.ByType "image" }}

    {{ range . }}

      {{- partial "image-processing.html" . -}}
      {{/* Move this to partial ^ */}}

      {{ $tinyw := default "500x" }}
      {{ $smallw := default "800x" }}
      {{ $mediumw := default "1200x" }}
      {{ $largew := default "1500x" }}

      {{ $tiny := (.Resize $tinyw ) "500w" }}
      {{ $small := (.Resize $smallw) "800w" }}
      {{ $medium := (.Resize $mediumw) "1200w" }}
      {{ $large := (.Resize $largew) "1500w" }}

      <a data-fancybox="gallery" href="{{ .Permalink }}">
        <img
          sizes="(min-width: 35em) 1200px, 100vw"
          srcset='
            {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryDefault }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ .Params.cover }},
            {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryMedium }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ .Params.cover }},
            {{ $.Site.Params.cloudinaryBaseUrl }}{{ $.Site.Params.cloudinaryLarge }}/{{ $.Site.Params.cloudinaryMediaUrl }}{{ .Params.cover }}
          '
          src="{{ .Permalink }}"
        >
        <br>
      </a>
    {{ end }}

  {{ end }}


</div>
